<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Toko Mekar Mandiri</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#2e7d32;
  --bg:#f4f6f8;
}
body{
  margin:0;
  font-family:Segoe UI, Arial;
  background:var(--bg);
}
header{
  background:linear-gradient(135deg,#2e7d32,#43a047);
  color:#fff;
  padding:20px;
  text-align:center;
}
.container{
  padding:15px;
  padding-bottom:200px;
}
.category h3{color:var(--primary)}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:12px;
}
.card{
  background:#fff;
  border-radius:14px;
  padding:12px;
  box-shadow:0 6px 14px rgba(0,0,0,.08);
}
.price{color:var(--primary);font-weight:bold}
.qty{
  display:flex;
  justify-content:center;
  gap:8px;
  margin-top:8px;
}
.qty button{
  width:30px;
  height:30px;
  border:none;
  background:var(--primary);
  color:#fff;
  border-radius:50%;
}
.cart{
  position:fixed;
  bottom:0;left:0;right:0;
  background:#fff;
  border-top:2px solid var(--primary);
  padding:12px;
}
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  align-items:center;
  justify-content:center;
}
.modal-content{
  background:#fff;
  padding:16px;
  border-radius:14px;
  width:90%;
  max-width:340px;
  text-align:center;
}
</style>
</head>

<body>

<header>
  <h2>Toko Mekar Mandiri</h2>
  <p>Sembako & Klontong â€¢ Online</p>
</header>

<div class="container" id="produkList"></div>

<div class="cart">
  <div id="cartText">ðŸ›’ Keranjang kosong</div>
  <div id="totalHarga"><b>Total: Rp0</b></div>
  <select id="pembayaran">
    <option>COD</option>
    <option>Transfer Bank</option>
    <option>QRIS</option>
  </select>
  <button onclick="checkout()">Checkout</button>
</div>

<!-- MODAL QRIS -->
<div class="modal" id="qrisModal">
  <div class="modal-content">
    <h3>ðŸ’³ Scan QRIS</h3>
    <p id="qrisTotal"></p>
    <img src="qris.jpg" style="width:100%;border-radius:10px">
    <button onclick="konfirmasi()">Saya sudah bayar</button><br><br>
    <button onclick="closeModal()">Tutup</button>
  </div>
</div>

<!-- MODAL STRUK -->
<div class="modal" id="strukModal">
  <div class="modal-content">
    <h3>ðŸ§¾ STRUK</h3>
    <div id="strukItem"></div>
    <p id="strukTotal"></p>
    <p id="strukBayar"></p>
    <button onclick="kirimWA()">Kirim ke WhatsApp</button><br><br>
    <button onclick="closeStruk()">Selesai</button>
  </div>
</div>

<script>
const whatsapp="6285162808162";

const data={
  "Sembako":[
    {nama:"Beras Medium",harga:14000},
    {nama:"Beras Super",harga:15500},
    {nama:"Gula Pasir",harga:17500},
    {nama:"Minyak Goreng 1L",harga:17500}
  ],
  "Kebutuhan":[
    {nama:"Mie Instan",harga:3000},
    {nama:"Sabun Mandi",harga:5000}
  ]
};

let cart=[];
let antrian=Number(localStorage.getItem("antrian")||0);

const produkList=document.getElementById("produkList");

for(let k in data){
  let sec=document.createElement("div");
  sec.innerHTML=<h3>${k}</h3><div class="grid"></div>;
  let grid=sec.querySelector(".grid");

  data[k].forEach(p=>{
    let id=p.nama.replace(/\s/g,'');
    let card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <h4>${p.nama}</h4>
      <div class="price">Rp${p.harga.toLocaleString()}</div>
      <div class="qty">
        <button onclick="kurang('${p.nama}')">âˆ’</button>
        <span id="qty-${id}">0</span>
        <button onclick="tambah('${p.nama}',${p.harga})">+</button>
      </div>`;
    grid.appendChild(card);
  });
  produkList.appendChild(sec);
}

function tambah(nama,harga){
  let item=cart.find(p=>p.nama===nama);
  if(item) item.qty++;
  else cart.push({nama,harga,qty:1});
  updateQty(nama);
  render();
}
function kurang(nama){
  let item=cart.find(p=>p.nama===nama);
  if(!item) return;
  item.qty--;
  if(item.qty<=0) cart=cart.filter(p=>p.nama!==nama);
  updateQty(nama);
  render();
}
function updateQty(nama){
  let id="qty-"+nama.replace(/\s/g,'');
  let item=cart.find(p=>p.nama===nama);
  document.getElementById(id).innerText=item?item.qty:0;
}

function render(){
  let text="",total=0;
  cart.forEach(p=>{
    let sub=p.qty*p.harga;
    text+=â€¢ ${p.nama} x${p.qty} = Rp${sub.toLocaleString()}\n;
    total+=sub;
  });
  document.getElementById("cartText").innerText=text||"ðŸ›’ Keranjang kosong";
  document.getElementById("totalHarga").innerText="Total: Rp"+total.toLocaleString();
}

function checkout(){
  if(cart.length===0) return alert("Keranjang kosong");
  let total=cart.reduce((a,b)=>a+b.qty*b.harga,0);
  if(pembayaran.value==="QRIS"){
    document.getElementById("qrisTotal").innerText="Total: Rp"+total.toLocaleString();
    qrisModal.style.display="flex";
  }else konfirmasi();
}

function konfirmasi(){
  qrisModal.style.display="none";
  tampilkanStruk();
}

function tampilkanStruk(){
  antrian++; localStorage.setItem("antrian",antrian);
  let html="",total=0;
  cart.forEach(p=>{
    let sub=p.qty*p.harga;
    html+=${p.nama} x${p.qty} = Rp${sub.toLocaleString()}<br>;
    total+=sub;
  });
  strukItem.innerHTML=html+<br>No Antrian: ${antrian};
  strukTotal.innerHTML="<b>Total: Rp"+total.toLocaleString()+"</b>";
  strukBayar.innerHTML="Pembayaran: "+pembayaran.value;
  strukModal.style.display="flex";
}

function kirimWA(){
  let msg="ðŸ§¾ STRUK TOKO MEKAR MANDIRI%0A";
  let total=0;
  cart.forEach(p=>{
    msg+=â€¢ ${p.nama} x${p.qty}%0A;
    total+=p.qty*p.harga;
  });
  msg+=%0ATotal: Rp${total.toLocaleString()};
  window.open(https://wa.me/${whatsapp}?text=${msg});
}

function closeModal(){qrisModal.style.display="none";}
function closeStruk(){strukModal.style.display="none";cart=[];render();}
</script>

</body>
</html>
